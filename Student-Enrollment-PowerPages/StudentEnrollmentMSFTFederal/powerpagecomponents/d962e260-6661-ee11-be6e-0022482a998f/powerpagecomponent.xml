<powerpagecomponent powerpagecomponentid="d962e260-6661-ee11-be6e-0022482a998f">
  <content>{
  "copy": "{% include 'Portal Web API Wrapper' -%}\r\n{%- include 'Course Form Logic' %}\r\n&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; padding: 8px; margin: 0px; text-align: left; min-height: 100px;'&gt;\r\n  &lt;div class='container' style='display: flex; flex-wrap: wrap;'&gt;\r\n    &lt;div class='col-md-12 columnBlockLayout course-form-header' style='flex-grow: 1; min-width: 300px; display: flex; flex-direction: column;'&gt;\r\n      &lt;div class='back-container'&gt;\r\n        &lt;a href='/admin-home'\r\n          &gt;&lt;img src='/back-arrow.svg' alt='back arrow' class='back-arrow' style='max-width: 100%;'&gt;\r\n          Back to my Courses\r\n        &lt;/a&gt;\r\n      &lt;/div&gt;\r\n      &lt;h2&gt;Create new course&lt;/h2&gt;\r\n      &lt;h5&gt;Course details&lt;/h5&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; margin: 0px; text-align: left; min-height: 374px; padding: 8px;'&gt;\r\n  &lt;div class='container course-form-container' style='display: flex; flex-wrap: wrap;'&gt;\r\n    &lt;div class='col-md-12 columnBlockLayout' style='flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; padding: 16px;'&gt;{% entityform name: 'ASP Create Course' %}&lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; margin: 0px; text-align: left; min-height: 374px; padding: 8px;'&gt;\r\n  &lt;div class='container btn-container' style='display: flex; flex-wrap: wrap;'&gt;\r\n    &lt;div class='col-md-6 columnBlockLayout' style='flex-grow: 1; display: flex; flex-direction: column; min-width: 300px;'&gt;&lt;button id='cancelButton1' data-toggle='modal' data-target='#discardModal1' class='button1 btn-secondary' style='margin-left: auto; margin-right: 0;'&gt;Discard&lt;/button&gt;&lt;/div&gt;\r\n    &lt;button id='createButton1' class='button1 btn-secondary' style='margin-right: 0; height: 37px; margin-top: 65px; width: 182px;'&gt;{{ snippets.Create }}&lt;/button&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;!-- START MODAL --&gt;\r\n&lt;div id='discardModal1' tabindex='-1' role='dialog' aria-labelledby='discardModalLabel' aria-hidden='true' class='modal fade'&gt;\r\n  &lt;div role='document' class='modal-dialog modal-dialog-centered'&gt;\r\n    &lt;div class='modal-content' style='border-radius: 16px;'&gt;\r\n      &lt;div class='modal-header'&gt;\r\n        &lt;h5 class='modal-title'&gt;Discard changes?&lt;/h5&gt;\r\n        &lt;button type='button' data-dismiss='modal' aria-label='Close' class='close'&gt;&lt;span aria-hidden='true'&gt;Ã—&lt;/span&gt;&lt;/button&gt;\r\n      &lt;/div&gt;\r\n      &lt;div class='modal-body'&gt;Would you like to discard any changes made?&lt;/div&gt;\r\n      &lt;div class='modal-footer'&gt;&lt;button id='confirmDiscard1' type='button' class='btn btn-primary'&gt;Discard&lt;/button&gt;&lt;/div&gt;\r\n    &lt;/div&gt;\r\n  &lt;/div&gt;\r\n&lt;/div&gt;\r\n&lt;!-- END MODAL --&gt;\r\n",
  "customcss": ".msos-option-selected\r\n{\r\n    background-color:#DAECED;\r\n}\r\n.msos-selection-container\r\n{\r\n    border-radius:10px;\r\n    overflow:hidden;\r\n}\r\n\r\n.msos-selected-items li:last-child{\r\n    border-radius:0px 0px 10px 10px;\r\n}\r\n.msos-input-container .msos-input {\r\n    height: 0px\r\n}",
  "customjavascript": "var documentbodyContents;\r\nvar courseImageType;\r\nvar courseImageName = '';\r\n\r\n//File upload function called by the PCF\r\nwindow.uploadImagePCF = function (name, memetype, body) {\r\n  courseImageType = memetype;\r\n  courseImageName = name;\r\n  documentbodyContents = body.substring(body.indexOf(',') + 1);\r\n};\r\n\r\n$(function () {\r\n  //ON PAGE LOAD\r\n  $(document).ready(function () {\r\n    //Create Course record\r\n    $('#createButton1').click(function (e) {\r\n      // validation\r\n      var isValid = true;\r\n      if (typeof entityFormClientValidate === 'function') {\r\n        if (entityFormClientValidate()) {\r\n          if (typeof Page_ClientValidate === 'function') {\r\n            if (Page_ClientValidate('')) {\r\n              clearIsDirty();\r\n              disableButtons();\r\n              createCourse();\r\n              this.value = '{{ snippets[\"Processing...\"] }}';\r\n            }\r\n          } else {\r\n            clearIsDirty();\r\n            disableButtons();\r\n            this.value = '{{ snippets[\"Processing...\"] }}';\r\n          }\r\n        } else {\r\n          isValid = false;\r\n          return false;\r\n        }\r\n      } else {\r\n        if (typeof Page_ClientValidate === 'function') {\r\n          if (Page_ClientValidate('')) {\r\n            clearIsDirty();\r\n            disableButtons();\r\n            this.value = '{{ snippets[\"Processing...\"] }}';\r\n          }\r\n        } else {\r\n          clearIsDirty();\r\n          disableButtons();\r\n          this.value = '{{ snippets[\"Processing...\"] }}';\r\n        }\r\n      }\r\n      WebForm_DoPostBackWithOptions(\r\n        new WebForm_PostBackOptions(\r\n          'ctl00$ContentContainer$EntityFormControl_5d59de143d3bec118c64000d3a8fd36d$InsertButton',\r\n          '',\r\n          true,\r\n          '',\r\n          '',\r\n          false,\r\n          true\r\n        )\r\n      );\r\n    });\r\n  });\r\n\r\n  // Cancel and redirect\r\n  const discardBtn = document.getElementById('confirmDiscard1');\r\n  discardBtn.onclick = function (event) {\r\n    window.location.href = \"{{ sitemarkers['C1 Home'].url }}\";\r\n  };\r\n\r\n  // Create button fix\r\n  const formCreateBtn = $('#EntityFormPanel &gt; div.actions').html();\r\n  $('#mainContent &gt; div &gt; div &gt; div &gt; div:nth-child(5) &gt; div &gt; div:nth-child(2)').html(formCreateBtn);\r\n  $('#mainContent &gt; div &gt; div &gt; div &gt; div:nth-child(5) &gt; div &gt; div:nth-child(2) &gt; #InsertButton').css({\r\n    width: '200px',\r\n    height: '36px',\r\n  });\r\n  $('#InsertButton').first().css({\r\n    display: 'none',\r\n  });\r\n});\r\n\r\nfunction createCourse() {\r\n  //required fields\r\n  var courseName = null;\r\n  var category = null;\r\n  var maxCapacity = null;\r\n  var startDate = null;\r\n  var endDate = null;\r\n  var registrationDate = null;\r\n\r\n  if (document.getElementById('msdynce_coursename').value) {\r\n    courseName = document.getElementById('msdynce_coursename').value;\r\n  }\r\n  if (document.getElementById('msdynce_coursecategory').value) {\r\n    category = document.getElementById('msdynce_coursecategory').value;\r\n  }\r\n  if (document.getElementById('msdynce_registerationmaxcapacity').value) {\r\n    maxCapacity = document.getElementById('msdynce_registerationmaxcapacity').value;\r\n  }\r\n  if (document.getElementById('msdynce_coursestartdateandtime_datepicker_description').value) {\r\n    startDate = moment(\r\n      Date.parse(document.getElementById('msdynce_coursestartdateandtime_datepicker_description').value)\r\n    );\r\n  }\r\n  if (document.getElementById('msdynce_courseenddateandtime_datepicker_description').value) {\r\n    endDate = moment(\r\n      Date.parse(document.getElementById('msdynce_courseenddateandtime_datepicker_description').value)\r\n    );\r\n  }\r\n  if (document.getElementById('msdynce_registerationdeadline_datepicker_description').value) {\r\n    registrationDate = moment(\r\n      Date.parse(document.getElementById('msdynce_registerationdeadline_datepicker_description').value)\r\n    );\r\n  }\r\n\r\n  let dataObject = {\r\n    msdynce_coursename: courseName,\r\n    msdynce_coursecategory: category,\r\n    msdynce_registerationmaxcapacity: maxCapacity,\r\n    msdynce_coursestartdateandtime: startDate,\r\n    msdynce_courseenddateandtime: endDate,\r\n    msdynce_registerationdeadline: registrationDate,\r\n  };\r\n\r\n  if (document.getElementById('msdynce_instructorname').value) {\r\n    dataObject['msdynce_InstructorName@odata.bind'] =\r\n      '/contacts(' + document.getElementById('msdynce_instructorname').value + ')';\r\n  }\r\n\r\n  var courseTypeValues = '';\r\n  var courseTypes = document\r\n    .getElementById('msdynce_coursetype_i')\r\n    .getElementsByClassName('msos-selecteditems-container')[0]\r\n    .getElementsByTagName('ul')[0]\r\n    .getElementsByTagName('li');\r\n  if (courseTypes.length &gt; 0) {\r\n    dataObject['msdynce_coursetype'] = '';\r\n    for (var i = 0; i &lt; courseTypes.length; i++) {\r\n      if (i !== courseTypes.length - 1) {\r\n        courseTypeValues += courseTypes[i].dataset.value + ', ';\r\n      } else {\r\n        courseTypeValues += courseTypes[i].dataset.value;\r\n      }\r\n    }\r\n    dataObject['msdynce_coursetype'] += courseTypeValues;\r\n  }\r\n\r\n  var oneTimeRadio = document.getElementById('msdynce_frequency_0');\r\n  var recurringRadio = document.getElementById('msdynce_frequency_1');\r\n\r\n  if (oneTimeRadio.checked) {\r\n    dataObject['msdynce_frequency'] = document.getElementById('msdynce_frequency_0').value;\r\n  }\r\n  if (recurringRadio.checked) {\r\n    dataObject['msdynce_frequency'] = document.getElementById('msdynce_frequency_1').value;\r\n  }\r\n\r\n  if (document.getElementById('msdynce_coursedescription').value) {\r\n    dataObject['msdynce_coursedescription'] = document.getElementById('msdynce_coursedescription').value;\r\n  }\r\n\r\n  var gradeLevelValues = '';\r\n  var gradeLevels = document\r\n    .getElementById('msdynce_coursegradelevel_i')\r\n    .getElementsByClassName('msos-selecteditems-container')[0]\r\n    .getElementsByTagName('ul')[0]\r\n    .getElementsByTagName('li');\r\n  if (gradeLevels.length &gt; 0) {\r\n    dataObject['msdynce_coursegradelevel'] = '';\r\n    for (var i = 0; i &lt; gradeLevels.length; i++) {\r\n      if (i !== gradeLevels.length - 1) {\r\n        gradeLevelValues += gradeLevels[i].dataset.value + ', ';\r\n      } else {\r\n        gradeLevelValues += gradeLevels[i].dataset.value;\r\n      }\r\n    }\r\n    dataObject['msdynce_coursegradelevel'] += gradeLevelValues;\r\n  }\r\n\r\n  var courseDaysValues = '';\r\n  var courseDays = document\r\n    .getElementById('msdynce_coursedays_i')\r\n    .getElementsByClassName('msos-selecteditems-container')[0]\r\n    .getElementsByTagName('ul')[0]\r\n    .getElementsByTagName('li');\r\n  if (courseDays.length &gt; 0) {\r\n    dataObject['msdynce_coursedays'] = '';\r\n    for (var i = 0; i &lt; courseDays.length; i++) {\r\n      if (i !== courseDays.length - 1) {\r\n        courseDaysValues += courseDays[i].dataset.value + ', ';\r\n      } else {\r\n        courseDaysValues += courseDays[i].dataset.value;\r\n      }\r\n    }\r\n    dataObject['msdynce_coursedays'] += courseDaysValues;\r\n  }\r\n\r\n  if (documentbodyContents) {\r\n    dataObject['msdynce_entityimage'] = documentbodyContents;\r\n    dataObject['msdynce_entityimage_file_name'] = courseImageName;\r\n    dataObject['msdynce_entityimage_file_type'] = courseImageType.substring(courseImageType.indexOf('/') + 1);\r\n  }\r\n\r\n  //Call the API\r\n  webapi.safeAjax({\r\n    type: 'POST',\r\n    url: '/_api/msdynce_courses',\r\n    contentType: 'application/json',\r\n    data: JSON.stringify(dataObject),\r\n    success: function (res, status, xhr) {\r\n      //Redirect back to home\r\n      window.location.href = \"{{ sitemarkers['C1 Home'].url }}\";\r\n    },\r\n    error: function (res, status, xhr) {\r\n      console.log(res.responseText);\r\n    },\r\n  });\r\n\r\n  window.location.href = \"{{ sitemarkers['C1 Home'].url }}\";\r\n}\r\n",
  "displayorder": 8,
  "enablerating": false,
  "enabletracking": false,
  "excludefromsearch": false,
  "feedbackpolicy": 756150000,
  "hiddenfromsitemap": false,
  "isroot": false,
  "pagetemplateid": "63cd665a-6661-ee11-be6e-0022482a9ca6",
  "parentpageid": "c9ec5562-6661-ee11-be6e-0022482a9f76",
  "partialurl": "create-course",
  "publishingstateid": "9562e260-6661-ee11-be6e-0022482a998f",
  "rootwebpageid": "c662e260-6661-ee11-be6e-0022482a998f",
  "sharedpageconfiguration": true,
  "summary": "&lt;p&gt;This is sample landing page for you to start building your website&lt;/p&gt;",
  "title": "[Admin] Create Course"
}</content>
  <iscustomizable>1</iscustomizable>
  <name>[Admin] Create Course</name>
  <powerpagecomponenttype>2</powerpagecomponenttype>
  <powerpagesiteid>
    <powerpagesiteid>d8ec5562-6661-ee11-be6e-0022482a9f76</powerpagesiteid>
  </powerpagesiteid>
  <powerpagesitelanguageid>
    <powerpagesitelanguageid>b8f67061-6661-ee11-be6e-0022482a91f4</powerpagesitelanguageid>
  </powerpagesitelanguageid>
  <searchcontent>[Admin] Create Course{% include 'Portal Web API Wrapper' -%}
{%- include 'Course Form Logic' %}
&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; padding: 8px; margin: 0px; text-align: left; min-height: 100px;'&gt;
  &lt;div class='container' style='display: flex; flex-wrap: wrap;'&gt;
    &lt;div class='col-md-12 columnBlockLayout course-form-header' style='flex-grow: 1; min-width: 300px; display: flex; flex-direction: column;'&gt;
      &lt;div class='back-container'&gt;
        &lt;a href='/admin-home'
          &gt;&lt;img src='/back-arrow.svg' alt='back arrow' class='back-arrow' style='max-width: 100%;'&gt;
          Back to my Courses
        &lt;/a&gt;
      &lt;/div&gt;
      &lt;h2&gt;Create new course&lt;/h2&gt;
      &lt;h5&gt;Course details&lt;/h5&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; margin: 0px; text-align: left; min-height: 374px; padding: 8px;'&gt;
  &lt;div class='container course-form-container' style='display: flex; flex-wrap: wrap;'&gt;
    &lt;div class='col-md-12 columnBlockLayout' style='flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; padding: 16px;'&gt;{% entityform name: 'ASP Create Course' %}&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class='row sectionBlockLayout' style='display: flex; flex-wrap: wrap; margin: 0px; text-align: left; min-height: 374px; padding: 8px;'&gt;
  &lt;div class='container btn-container' style='display: flex; flex-wrap: wrap;'&gt;
    &lt;div class='col-md-6 columnBlockLayout' style='flex-grow: 1; display: flex; flex-direction: column; min-width: 300px;'&gt;&lt;button id='cancelButton1' data-toggle='modal' data-target='#discardModal1' class='button1 btn-secondary' style='margin-left: auto; margin-right: 0;'&gt;Discard&lt;/button&gt;&lt;/div&gt;
    &lt;button id='createButton1' class='button1 btn-secondary' style='margin-right: 0; height: 37px; margin-top: 65px; width: 182px;'&gt;{{ snippets.Create }}&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- START MODAL --&gt;
&lt;div id='discardModal1' tabindex='-1' role='dialog' aria-labelledby='discardModalLabel' aria-hidden='true' class='modal fade'&gt;
  &lt;div role='document' class='modal-dialog modal-dialog-centered'&gt;
    &lt;div class='modal-content' style='border-radius: 16px;'&gt;
      &lt;div class='modal-header'&gt;
        &lt;h5 class='modal-title'&gt;Discard changes?&lt;/h5&gt;
        &lt;button type='button' data-dismiss='modal' aria-label='Close' class='close'&gt;&lt;span aria-hidden='true'&gt;Ã—&lt;/span&gt;&lt;/button&gt;
      &lt;/div&gt;
      &lt;div class='modal-body'&gt;Would you like to discard any changes made?&lt;/div&gt;
      &lt;div class='modal-footer'&gt;&lt;button id='confirmDiscard1' type='button' class='btn btn-primary'&gt;Discard&lt;/button&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;!-- END MODAL --&gt;
[Admin] Create Course</searchcontent>
  <statecode>0</statecode>
  <statuscode>1</statuscode>
</powerpagecomponent>