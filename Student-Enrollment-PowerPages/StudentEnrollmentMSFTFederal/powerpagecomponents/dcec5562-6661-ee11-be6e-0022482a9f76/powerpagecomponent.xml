<powerpagecomponent powerpagecomponentid="dcec5562-6661-ee11-be6e-0022482a9f76">
  <content>{
  "source": "{% block main %}\r\n\r\n{% if request.params['page'] | xml_escape %}\r\n{% assign page = request.params['page'] | xml_escape | integer | default: 1 %}\r\n{% else %}\r\n{% assign page = 1 %}\r\n{% endif %}\r\n\r\n{% assign previousPage = page | minus: 1 %}\r\n{% assign nextPage = page | plus: 1 %}\r\n\r\n{% assign cardsPerPageValue = settings['ASP/Pagination/CardsPerPage'] | default: 20 %}\r\n{% assign cardsPerPage = cardsPerPageValue | times: 1.0 %}\r\n{% assign cardCounter = 1 %}\r\n\r\n{% assign seasonFilter = request.params['season'] | xml_escape | default: currentSeason %}\r\n\r\n{% if request.params['attendees'] | xml_escape %}\r\n{% assign attendeeFilters = request.params['attendees'] | xml_escape | split: ',' %}\r\n{% endif %}\r\n\r\n{% fetchxml registrations %}\r\n&lt;fetch distinct=\"false\" mapping=\"logical\" output-format=\"xml-platform\" version=\"1.0\" count=\"{{ cardsPerPage }}\" returntotalrecordcount=\"true\" page=\"{{ page }}\"&gt;\r\n    &lt;entity name=\"msdynce_registration\"&gt;\r\n        &lt;attribute name=\"msdynce_registrationid\"/&gt;\r\n        &lt;attribute name=\"msdynce_attendeename\"/&gt;\r\n        &lt;attribute name=\"msdynce_name\"/&gt;\r\n        &lt;attribute name=\"msdynce_coursestartdate\"/&gt;\r\n        &lt;attribute name=\"msdynce_courseenddate\"/&gt;\r\n        &lt;attribute name=\"createdon\"/&gt;\r\n        &lt;attribute name=\"msdynce_parent\"/&gt;\r\n        &lt;order descending=\"false\" attribute=\"msdynce_name\"/&gt;\r\n        &lt;filter type=\"and\"&gt;\r\n            &lt;condition attribute=\"statecode\" value=\"0\" operator=\"eq\"/&gt;\r\n        &lt;/filter&gt;\r\n        &lt;filter type=\"or\"&gt;\r\n            &lt;condition attribute=\"msdynce_parent\" value=\"{{user.id}}\" operator=\"eq\"/&gt;\r\n            &lt;condition attribute=\"msdynce_attendeename\" value=\"{{user.id}}\" operator=\"eq\"/&gt;\r\n        &lt;/filter&gt;\r\n        &lt;link-entity name=\"contact\" from=\"contactid\" to=\"msdynce_attendeename\" visible=\"false\" link-type=\"outer\"&gt;\r\n          &lt;attribute name=\"fullname\" alias=\"fullname\" /&gt;\r\n          &lt;attribute name=\"contactid\" alias=\"parent\" /&gt;\r\n        &lt;/link-entity&gt;\r\n        &lt;link-entity name=\"msdynce_course\" from=\"msdynce_courseid\" to=\"msdynce_courseid\" visible=\"false\" link-type=\"outer\"&gt;\r\n          &lt;attribute name=\"msdynce_courseid\" alias=\"course\" /&gt;\r\n          &lt;attribute name=\"msdynce_coursename\" alias=\"coursename\" /&gt;\r\n          &lt;attribute name=\"msdynce_coursestartdateandtime\" alias=\"coursestart\" /&gt;\r\n          &lt;attribute name=\"msdynce_courseenddateandtime\" alias=\"courseend\" /&gt;\r\n          &lt;attribute name=\"msdynce_coursedays\" alias=\"coursedays\" /&gt;\r\n          &lt;attribute name=\"msdynce_coursetype\" alias=\"coursetype\" /&gt;\r\n          &lt;attribute name=\"msdynce_instructor\" /&gt; \r\n          &lt;attribute name=\"msdynce_coursedescription\" /&gt;     \r\n        &lt;/link-entity&gt;\r\n        {% if request.params['search'] | xml_escape %}\r\n          {% assign searchTxt = request.params['search'] | xml_escape %}\r\n          &lt;filter type=\"or\" &gt;\r\n            &lt;condition entityname=\"msdynce_course\" attribute=\"msdynce_coursename\" operator=\"like\" value=\"%{{searchTxt}}%\" /&gt;\r\n            &lt;condition entityname=\"msdynce_course\" attribute=\"msdynce_instructor\" operator=\"like\" value=\"%{{searchTxt}}%\" /&gt;\r\n            &lt;condition entityname=\"msdynce_course\" attribute=\"msdynce_coursedescription\" operator=\"like\" value=\"%{{searchTxt}}%\" /&gt;\r\n          &lt;/filter&gt;\r\n        {% endif %}\r\n\r\n        {% if request.params['attendees'] | xml_escape %}\r\n          &lt;filter type=\"or\"&gt;\r\n          {% for v in attendeeFilters %}\r\n          &lt;condition attribute=\"msdynce_attendeename\" operator=\"eq\" value=\"{{v}}\" /&gt;\r\n          {% endfor %}\r\n          &lt;/filter&gt;\r\n        {% endif %}\r\n    &lt;/entity&gt;\r\n&lt;/fetch&gt;\r\n{% endfetchxml %}\r\n\r\n&lt;!-- Get Course Types option set values --&gt;\r\n{% fetchxml coursetypes %}\r\n&lt;fetch distinct=\"true\"&gt;\r\n  &lt;entity name=\"stringmap\"&gt;\r\n    &lt;attribute name=\"attributevalue\" /&gt;\r\n    &lt;attribute name=\"displayorder\" /&gt;\r\n    &lt;attribute name=\"value\" /&gt;\r\n    &lt;attribute name=\"attributename\" /&gt;\r\n    &lt;attribute name=\"objecttypecode\" /&gt;\r\n    &lt;filter&gt;\r\n      &lt;condition attribute=\"attributename\" operator=\"eq\" value=\"msdynce_coursetype\" /&gt;\r\n      &lt;condition attribute=\"langid\" operator=\"eq\" value=\"{{website.adx_website_language}}\" /&gt;\r\n    &lt;/filter&gt;\r\n    &lt;order attribute=\"objecttypecode\" descending=\"true\" /&gt;\r\n    &lt;order attribute=\"displayorder\" /&gt;\r\n  &lt;/entity&gt;\r\n&lt;/fetch&gt;\r\n{% endfetchxml %}\r\n\r\n{% assign seasonFilter = request.params['season'] | xml_escape | default: currentSeason %}\r\n\r\n{% if registrations.results and registrations.results.entities %}\r\n    {% assign registrationResults = registrations.results.entities %}\r\n    {% assign filteredIndices = \"\" %}\r\n    {% assign index = 0 %}\r\n    {% unless request.params['search'] | xml_escape %}\r\n    {% for registration in registrationResults %}\r\n      {% assign enddatemonth = registration.msdynce_courseenddateandtime | date: \"MM\" | integer%}\r\n      {% assign strIndex = index | string %}\r\n      {% case seasonFilter  %}\r\n        {% when fall %}\r\n          {% if enddatemonth &gt;= 9 and enddatemonth &lt;= 11 %}\r\n            {% if filteredIndices.size &gt; 0 %}\r\n              {% assign filteredIndices = filteredIndices | append: \",\" %}\r\n            {% endif %}\r\n            {% assign filteredIndices = filteredIndices | append: strIndex %}\r\n          {% endif %}\r\n        {% when winter %}\r\n          {% if enddatemonth == 12 or enddatemonth &lt;= 2 %}\r\n            {% if filteredIndices.size &gt; 0 %}\r\n              {% assign filteredIndices = filteredIndices | append: \",\" %}\r\n            {% endif %}\r\n            {% assign filteredIndices = filteredIndices | append: strIndex  %}\r\n          {% endif %}\r\n        {% when spring %}\r\n          {% if enddatemonth &gt;= 3 and enddatemonth &lt;= 5 %}\r\n            {% if filteredIndices.size &gt; 0 %}\r\n              {% assign filteredIndices = filteredIndices | append: \",\" %}\r\n            {% endif %}  \r\n            {% assign filteredIndices = filteredIndices | append: strIndex  %}\r\n          {% endif %}\r\n        {% when summer %}\r\n          {% if enddatemonth &gt;= 6 and enddatemonth &lt;= 8 %}\r\n            {% if filteredIndices.size &gt; 0 %}\r\n              {% assign filteredIndices = filteredIndices | append: \",\" %}\r\n            {% endif %}\r\n            {% assign filteredIndices = filteredIndices | append: strIndex %}\r\n          {% endif %}\r\n      {% endcase %}\r\n      {% assign index = index | plus: 1 %}\r\n    {% endfor %}\r\n    {% endunless %}\r\n    {% if filteredIndices.size &gt; 0 %}\r\n      {% assign filteredIndices = filteredIndices | split: \",\" %}\r\n      {% assign totalCount = filteredIndices.size %}\r\n      {% assign pages = totalCount | decimal | divided_by: cardsPerPage | ceil %}\r\n\r\n      {% for i in filteredIndices %}\r\n        {% assign index = i | integer %}\r\n        {% assign registration = registrationResults[index] %}\r\n        &lt;!-- Course Days --&gt;\r\n        {% assign dayvalues = '' %}\r\n\r\n        {% if request.IsPreview != true %}\r\n          {% if registration.coursedays %}\r\n            {% for day in registration.coursedays %}\r\n                {% assign dayvalues = dayvalues | append:'&lt;p&gt;'| append:day.label| append:'&lt;/p&gt;' %}\r\n            {% endfor %}\r\n          {% endif %}  \r\n        {% endif %}\r\n        &lt;!-- END - Course Days --&gt;\r\n\r\n        &lt;!-- Course Types --&gt;\r\n        {% assign typeValues = '' %}\r\n\r\n        {% if request.IsPreview != true %}\r\n            {% if registration.coursetype %}\r\n            {% for type in registration.coursetype %}\r\n                {% if forloop.index == 2 %}\r\n                {% assign typeValues = typeValues | append:'&lt;span class=\"separator\"&gt; | &lt;/span&gt;' %} \r\n                {% endif %}\r\n                {% if type.value == 441790000 %}\r\n                {% assign typeValues = typeValues | append: '&lt;img class=\"type-image\" src=\"/format-icon.svg\" alt=\"in-person icon\"&gt;' | append:'&lt;span&gt;'| append:type.label| append:'&lt;/span&gt;' %}  \r\n                {% else %}\r\n                {% assign typeValues = typeValues | append: '&lt;img class=\"type-image\" src=\"/virtual.svg\" alt=\"Virtual course icon\"&gt;' | append:'&lt;span&gt;'| append:type.label| append:'&lt;/span&gt;' %}  \r\n                {% endif %}\r\n            {% endfor %}\r\n            {% endif %}  \r\n        {% endif %}\r\n        &lt;!-- END - Course Types --&gt;\r\n\r\n        {% editable snippets 'Card/Registrations' type: 'html' %}  \r\n\r\n      {% endfor %}\r\n\r\n      {% include 'Custom Pagination' %}\r\n    {% else %}\r\n      &lt;h2&gt;{{ snippets[\"NoRegistrationsFound\"] }}&lt;/h2&gt;\r\n    {% endif %}\r\n  {% else %}\r\n      &lt;h2&gt;{{ snippets[\"NoRegistrationsFound\"] }}&lt;/h2&gt;\r\n  {% endif %}\r\n{% endblock %}"
}</content>
  <iscustomizable>1</iscustomizable>
  <name>Registration Catalog</name>
  <powerpagecomponenttype>8</powerpagecomponenttype>
  <powerpagesiteid>
    <powerpagesiteid>d8ec5562-6661-ee11-be6e-0022482a9f76</powerpagesiteid>
  </powerpagesiteid>
  <statecode>0</statecode>
  <statuscode>1</statuscode>
</powerpagecomponent>