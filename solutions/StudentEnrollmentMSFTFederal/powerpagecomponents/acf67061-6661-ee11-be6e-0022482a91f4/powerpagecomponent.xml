<powerpagecomponent powerpagecomponentid="acf67061-6661-ee11-be6e-0022482a91f4">
  <content>{
  "copy": "{% include 'Portal Web API Wrapper' %}\n&lt;div class=\"row sectionBlockLayout\" style=\"display: flex; flex-wrap: wrap; padding: 8px; margin: 0px; min-height: auto;\"&gt;\n  &lt;div class=\"container\" style=\"column-gap: 0px;\"&gt;\n    &lt;div class=\"col-md-12\" style=\"flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; align-items: center; margin: 60px 0px; padding: 16px; width: calc(100% - 0px);\"&gt;\n      &lt;h2&gt;After school events&lt;/h2&gt;\n      &lt;p class=\"home-header-subtitle\"&gt;Browse all the events for 2022-2023&lt;/p&gt;\n    &lt;/div&gt;\n    &lt;div class=\"catalog-cards col-md-12 columnBlockLayout nopadding\" style=\"word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; margin: 60px 0px; padding: 16px; width: calc(100% - 0px);\"&gt;\n      &lt;div class=\"col-md-12\"&gt;{% include 'Dropdown Filters' %}&lt;/div&gt;\n      {% include 'Course Catalog' %}\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n",
  "customjavascript": "$(function(){\r\n    var categoryFilter = \"{{request.params['category'] | xml_escape }}\";\r\n    var seasonFilter = \"{{request.params['season'] | xml_escape }}\";\r\n    var gradeFilterString = \"{{request.params['level'] | xml_escape }}\";\r\n    var gradeFilterArray;\r\n    var typeFilterString = \"{{request.params['type'] | xml_escape }}\";\r\n    var typeFilterArray;\r\n\r\n    let CATEGORY_NAME = 'Category';\r\n    let SEASON_NAME = 'Season';\r\n    let GRADE_NAME = 'Grade Level';\r\n    let TYPE_NAME = 'Course Type';\r\n\r\n    // todo-cj : need to consolidate mobile and desktop\r\n\r\n    // Desktop selectors\r\n    let $courseFilters = $('.course-selector');\r\n\r\n    let filters = {\r\n        category: CATEGORY_NAME,\r\n        season: SEASON_NAME,\r\n        grade: GRADE_NAME,\r\n        type: TYPE_NAME\r\n    };\r\n\r\n    $courseFilters.each(function(idx) {\r\n        $(this).on('change', function(e) {\r\n            e.preventDefault();\r\n            let targetName = e.target.name;\r\n            let value = $(this).val();\r\n\r\n            switch (targetName) {\r\n                case filters.category:\r\n                    categoryFilter = value;\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    break;\r\n                case filters.season:\r\n                    seasonFilter = value;\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    break;\r\n                case filters.grade:\r\n                    gradeFilterString = value;\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    break;\r\n                case filters.type:\r\n                    typeFilterString = value;\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    break;\r\n                default:\r\n                    console.log('nothing selected');\r\n            }\r\n        });\r\n    });\r\n\r\n    if (gradeFilterString != \"\" &amp;&amp; gradeFilterString.includes(\",\"))\r\n        gradeFilterArray = gradeFilterString.split(\",\")\r\n    else if (gradeFilterString != \"\")\r\n        gradeFilterArray = [gradeFilterString];\r\n    else\r\n        gradeFilterArray = [];\r\n\r\n    if (typeFilterString != \"\" &amp;&amp; typeFilterString.includes(\",\"))\r\n        typeFilterArray = typeFilterString.split(\",\")\r\n    else if (typeFilterString != \"\")\r\n        typeFilterArray = [typeFilterString];\r\n    else\r\n        typeFilterArray = [];\r\n    \r\n\r\n    //Get each of the course's images\r\n    $(\".course-card-img\").each(function(){\r\n        const id = this.dataset.courseid;\r\n        const current = this;\r\n        webapi.safeAjax({\r\n            type: \"GET\",\r\n            url: \"/_api/msdynce_courses(\"+ id +\")/msdynce_entityimage/?size=full\",\r\n            contentType: \"application/json\",\r\n            success: function (res, status) {\r\n                if (res){\r\n                    const imgURL =  \"data:image/png;base64,\" + res.value;\r\n                    const imgHTML = \"&lt;img class='card-img-top gradient-image' src=\" + imgURL + \" alt='course photo'&gt;&lt;/img&gt;\";\r\n                    $(current).html(imgHTML);\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    //Keep the filter dropdowns from collapsing after clicking an option\r\n    $(document).on('click', '.catalog-dropdown-filters .dropdown-menu', function (e) {\r\n        e.stopPropagation();\r\n    });\r\n\r\n    // Close modal popups if user clicks outside the modal, on mobile\r\n    $(document).on(\"click\",'.modal-backdrop', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();        \r\n        window.location.href=window.location.href\r\n    })\r\n\r\n     $(\"#courseSeason+ul li\").on(\"click\", function(){\r\n      \r\n        seasonFilter = this.dataset.val;\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    //Season mobile filter\r\n    $(\"#applySeasonCatalog\").on(\"click\", function(){\r\n      //Get the selected season value\r\n      var selectedSeason = $(\"input:radio[name='SeasonMobile']:checked\").val();\r\n      seasonFilter = selectedSeason;\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    $('.radioSeasonMobile').on(\"change\", function() {\r\n\r\n      if(this.checked)\r\n      {\r\n        $('input[name=\"SeasonMobile\"]').parent().removeClass(\"filterSelected\");\r\n        $(this).parent().addClass(\"filterSelected\");\r\n      }\r\n      else\r\n      $(this).parent().removeClass(\"filterSelected\");\r\n      \r\n    });\r\n\r\n    $(\"#courseGrades+ul input[type='checkbox']\").on(\"change\", function(){\r\n        if (this.checked){\r\n            gradeFilterArray.push(this.value);\r\n        } else {\r\n            var pos = gradeFilterArray.indexOf(this.value);\r\n            gradeFilterArray.splice(pos, 1);\r\n        }\r\n        gradeFilterString = arrayToString(gradeFilterArray);\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    // Grade filter for mobile\r\n    $('#applyLevel').on(\"click\", function(){\r\n      \r\n        gradeFilterString = $(\"input[name=LevelMobile]:checked\").map(function () {\r\n                return ($(this).val());\r\n        }).get().join(',');\r\n\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    \r\n    });\r\n\r\n    $('.checkLevelMobile').on(\"change\", function() {\r\n\r\n      if(this.checked){\r\n        $(this).parent().addClass(\"filterSelected\");\r\n      }\r\n      else {\r\n        $(this).parent().removeClass(\"filterSelected\");\r\n      }\r\n    });\r\n\r\n    $(\"#courseTypes+ul input[type='checkbox']\").on(\"change\", function(){\r\n        if (this.checked){\r\n            typeFilterArray.push(this.value);\r\n        } else {\r\n            var pos = typeFilterArray.indexOf(this.value);\r\n            typeFilterArray.splice(pos, 1);\r\n        }\r\n        typeFilterString = arrayToString(typeFilterArray);\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    $('#applyType').on(\"click\", function(){\r\n      \r\n        typeFilterString = $(\"input[name=TypeMobile]:checked\").map(function () {\r\n                return ($(this).val());\r\n            }).get().join(',');\r\n\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n\r\n    });\r\n\r\n    $('.checkTypeMobile').on(\"change\", function() {\r\n\r\n      if(this.checked){\r\n        $(this).parent().addClass(\"filterSelected\");\r\n      }\r\n      else {\r\n        $(this).parent().removeClass(\"filterSelected\");\r\n      }\r\n    });\r\n\r\n    //Category desktop version configuration \r\n    $('.categoryListItem').focusin(function() {\r\n        $(this).addClass('categorySelected');\r\n        let category = $(this).children().children().attr('value');\r\n        categoryFilter = category;\r\n        $(this).keydown(function (e) {\r\n            if (e.key == \" \" || e.key == \"Enter\") {\r\n                buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n            }\r\n        })\r\n    });\r\n\r\n    $('.categoryListItem').focusout(function() {\r\n        $(this).removeClass('categorySelected');\r\n        $(this).off(\"keydown\", \"input\");\r\n    });\r\n\r\n    $('#applyCategoryDesktop').on('click', function() {\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    $('#categoryAll').on('click', function() {\r\n        categoryFilter = '';\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    //Season selection desktop version configuration\r\n\r\n    $('#courseSeason+ul li').focusin(function() {\r\n        $(this).addClass('selectedSeason');\r\n        $(this).keydown(function(e) {\r\n            if (e.key == \" \" || e.key == \"Enter\") {\r\n                seasonFilter = this.dataset.val;\r\n                buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                \r\n            }\r\n        })\r\n    })\r\n\r\n    $('#courseSeason+ul li').focusout(function() {\r\n        $(this).removeClass('selectedSeason')\r\n    })\r\n\r\n    //Grade selection desktop configuration\r\n\r\n    $(\"#courseGrades+ul input[type='checkbox']\").focusin(function() {\r\n        $(this).parent().addClass('selectedGrade');\r\n        $(this).keydown(function(e) {\r\n            if (e.key == \" \" || e.key == \"Enter\") {\r\n                e.preventDefault();\r\n                e.stopPropagation();  \r\n                if (!this.checked) {\r\n                    this.checked = true;\r\n                    gradeFilterArray.push(this.value)\r\n                } else {\r\n                    this.checked = false;\r\n                    var pos = gradeFilterArray.indexOf(this.value);\r\n                    gradeFilterArray.splice(pos, 1);\r\n                }\r\n                $('#gradeDropdown').on('hide.bs.dropdown', function() {\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); \r\n                    gradeFilterString = arrayToString(gradeFilterArray);\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                })\r\n                $(this).keydown(function(e) {\r\n                    if (e.key == \"Escape\") {\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); \r\n                    gradeFilterString = arrayToString(gradeFilterArray);\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    }\r\n                })\r\n            } else if (e.key == \"Escape\") {\r\n                $('#gradeDropdown').dropdown('toggle');\r\n            }\r\n        })\r\n    });\r\n\r\n    $(\"#courseGrades+ul input[type='checkbox']\").focusout(function() {\r\n        $(this).parent().removeClass('selectedGrade');\r\n        $(this).off(\"keydown\", \"input\");\r\n    })\r\n\r\n    //Type selection desktop configuration\r\n    $(\"#courseTypes+ul input[type='checkbox']\").focusin(function() {\r\n        $(this).parent().addClass('selectedType');\r\n        $(this).keydown(function(e) {\r\n            if (e.key == \" \" || e.key == \"Enter\") {\r\n                e.preventDefault();\r\n                e.stopPropagation();  \r\n                if (!this.checked) {\r\n                    this.checked = true;\r\n                    typeFilterArray.push(this.value)\r\n                } else {\r\n                    this.checked = false;\r\n                    var pos = typeFilterArray.indexOf(this.value);\r\n                    typeFilterArray.splice(pos, 1);\r\n                }\r\n                $('#typeDropdown').on('hide.bs.dropdown', function() {\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); \r\n                    typeFilterString = arrayToString(typeFilterArray);\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                })\r\n                $(this).keydown(function(e) {\r\n                    if (e.key == \"Escape\") {\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); \r\n                    typeFilterString = arrayToString(typeFilterArray);\r\n                    buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n                    }\r\n                })\r\n            } else if (e.key == \"Escape\") {\r\n                $('#typeDropdown').dropdown('toggle');\r\n            }\r\n        })\r\n    });\r\n\r\n    $(\"#courseTypes+ul input[type='checkbox']\").focusout(function() {\r\n        $(this).parent().removeClass('selectedType');\r\n        $(this).off(\"keydown\", \"input\");\r\n    })\r\n\r\n    //Dropdown button CSS\r\n    $('#courseSeason, #courseGrades, #courseTypes').focusin(function() {\r\n        $(this).addClass('categorySelected');\r\n    });\r\n\r\n    $('#courseSeason, #courseGrades, #courseTypes').focusout(function() {\r\n        $(this).removeClass('categorySelected');\r\n    });\r\n\r\n    //Category mobile filter\r\n    $(\"#applyCategory\").on(\"click\", function(){\r\n        var checkedValue = $(\"input:radio[name='CategoryMobile']:checked\").val();\r\n        categoryFilter = checkedValue;\r\n\r\n        buildUrl(categoryFilter, seasonFilter, gradeFilterString, typeFilterString);\r\n    });\r\n\r\n    $('.radioCategoryMobile').on(\"change\", function() {\r\n\r\n      if(this.checked)\r\n      {\r\n        $('input[name=\"CategoryMobile\"]').parent().removeClass(\"filterSelected\");\r\n        $(this).parent().addClass(\"filterSelected\");\r\n      }\r\n      else\r\n      $(this).parent().removeClass(\"filterSelected\");\r\n      \r\n    });\r\n\r\n    //Search\r\n    $(\"#btnSearch\").on(\"click\", function(){\r\n        var txt = $(\"#txtsearch\");\r\n        buildUrlSearch(txt.val());\r\n    });\r\n\r\n    // Trigger search on press of Enter key\r\n    var input = document.getElementById(\"txtsearch\");\r\n    input.addEventListener(\"keyup\", function(event) {\r\n      // Number 13 is the \"Enter\" key on the keyboard\r\n      if (event.key === \" \") {\r\n        if (input.value.length &gt; 0){\r\n          // Trigger the button element with a click\r\n          document.getElementById(\"btnSearch\").click();\r\n        }\r\n      }\r\n    });\r\n\r\n    $('#txtsearch').on(\"change\", function(){\r\n      if(this.value.length == 0){\r\n        var url = window.location.href;\r\n\r\n        url = url.replace(window.location.search, \"\");\r\n\r\n        if (url != \"\")\r\n        window.location.href = url;\r\n      }\r\n    });\r\n\r\n});\r\n\r\n    function buildUrl(category, season, grades, types){\r\n        console.log(category)\r\n        var queryUrl = window.location.href;\r\n        //Remove all queries\r\n        queryUrl = queryUrl.replace(window.location.search, \"\");\r\n        //Set the page to 1\r\n        queryUrl = queryUrl + \"?page=1\";\r\n        if (category &amp;&amp; category != \"\")\r\n            queryUrl = queryUrl + \"&amp;category=\" + category;\r\n        if (season &amp;&amp; season != \"\")\r\n            queryUrl = queryUrl + \"&amp;season=\" + season;\r\n        if (grades &amp;&amp; grades != \"\")\r\n            queryUrl = queryUrl + \"&amp;level=\" + grades;\r\n        if (types &amp;&amp; types != \"\")\r\n            queryUrl = queryUrl + \"&amp;type=\" + types;\r\n\r\n        window.location.href = queryUrl;\r\n    }\r\n\r\n    function buildUrlSearch(search){\r\n        var queryUrl = window.location.href;\r\n        //Remove all queries\r\n        queryUrl = queryUrl.replace(window.location.search, \"\");\r\n        //Set the page to 1\r\n        queryUrl = queryUrl + \"?page=1\";\r\n        if (search &amp;&amp; search != \"\")\r\n            queryUrl = queryUrl + \"&amp;search=\" + search;\r\n\r\n        window.location.href = queryUrl;\r\n    }\r\n\r\n    function arrayToString(arrayVar) {\r\n        var stringVar = \"\";\r\n        arrayVar.forEach(function (element, i, array) {\r\n            var auxString = arrayVar[i].toString();\r\n            if (i == 0)\r\n                stringVar = auxString;\r\n            else\r\n                stringVar = stringVar + \",\" + auxString;\r\n        });\r\n        //If nothing was selected, set the variable to null or the API will throw an error\r\n        if (stringVar == \"\")\r\n            stringVar = null;\r\n\r\n        return stringVar;\r\n    }",
  "displayorder": 1,
  "enablerating": false,
  "enabletracking": false,
  "excludefromsearch": false,
  "feedbackpolicy": 756150005,
  "hiddenfromsitemap": false,
  "isroot": false,
  "pagetemplateid": "63cd665a-6661-ee11-be6e-0022482a9ca6",
  "partialurl": "/",
  "publishingstateid": "9562e260-6661-ee11-be6e-0022482a998f",
  "rootwebpageid": "c9ec5562-6661-ee11-be6e-0022482a9f76",
  "sharedpageconfiguration": false,
  "summary": "&lt;p&gt;This is a sample landing page for you to start creating your website.&lt;/p&gt;",
  "title": "Home"
}</content>
  <iscustomizable>1</iscustomizable>
  <name>Home</name>
  <powerpagecomponenttype>2</powerpagecomponenttype>
  <powerpagesiteid>
    <powerpagesiteid>d8ec5562-6661-ee11-be6e-0022482a9f76</powerpagesiteid>
  </powerpagesiteid>
  <powerpagesitelanguageid>
    <powerpagesitelanguageid>b8f67061-6661-ee11-be6e-0022482a91f4</powerpagesitelanguageid>
  </powerpagesitelanguageid>
  <searchcontent>Home{% include 'Portal Web API Wrapper' %}
&lt;div class="row sectionBlockLayout" style="display: flex; flex-wrap: wrap; padding: 8px; margin: 0px; min-height: auto;"&gt;
  &lt;div class="container" style="column-gap: 0px;"&gt;
    &lt;div class="col-md-12" style="flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; align-items: center; margin: 60px 0px; padding: 16px; width: calc(100% - 0px);"&gt;
      &lt;h2&gt;After school events&lt;/h2&gt;
      &lt;p class="home-header-subtitle"&gt;Browse all the events for 2022-2023&lt;/p&gt;
    &lt;/div&gt;
    &lt;div class="catalog-cards col-md-12 columnBlockLayout nopadding" style="word-break: break-word; flex-grow: 1; display: flex; flex-direction: column; min-width: 300px; margin: 60px 0px; padding: 16px; width: calc(100% - 0px);"&gt;
      &lt;div class="col-md-12"&gt;{% include 'Dropdown Filters' %}&lt;/div&gt;
      {% include 'Course Catalog' %}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
Home</searchcontent>
  <statecode>0</statecode>
  <statuscode>1</statuscode>
</powerpagecomponent>